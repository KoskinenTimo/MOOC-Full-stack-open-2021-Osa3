(this["webpackJsonppuhelinluettelon-backend"]=this["webpackJsonppuhelinluettelon-backend"]||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var c=n(15),a=n.n(c),r=n(3),s=n(2),o=n(4),u=n.n(o),i="/api/persons",l={getAll:function(){return u.a.get(i).then((function(e){return e.data})).catch((function(e){return console.error(e),[]}))},create:function(e){return u.a.post(i,e).then((function(e){return e.data})).catch((function(e){throw e}))},update:function(e,t){return u.a.put("".concat(i,"/").concat(e),t).then((function(e){return e.data})).catch((function(e){throw e}))},destroy:function(e){return u.a.delete("".concat(i,"/").concat(e)).then((function(e){return e.status})).catch((function(e){return console.log(e.status),e.response.status}))}},d=n(0),j=function(e){var t=e.persons,n=e.search,c=e.setpersons,a=e.setActionCompleted,r=(e.actionCompleted,function(e){window.confirm("Delete ".concat(e.name,"?"))&&l.destroy(e.id).then((function(n){204===n?(c(t.filter((function(t){return t.id!==e.id}))),a({message:"".concat(e.name," deleted."),type:"valid"}),setTimeout((function(){a(null)}),4e3)):404===n&&(a({message:"".concat(e.name," has been deleted already."),type:"error"}),setTimeout((function(){a(null)}),4e3))}))});return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h2",{children:"Numbers"}),Object(d.jsxs)("table",{children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"Name"}),Object(d.jsx)("th",{children:"Number"})]})}),Object(d.jsx)("tbody",{children:t.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())})).map((function(e){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:e.name}),Object(d.jsx)("td",{children:e.number}),Object(d.jsx)("td",{children:Object(d.jsx)("button",{onClick:function(){return r(e)},children:"Delete"})})]},e.id)}))})]})]})},h=function(e){var t=e.newName,n=e.newNumber,c=e.handleInputChange,a=e.persons,r=e.setpersons,s=e.setNewName,o=e.setNewNumber,u=e.setActionCompleted,i=function(e,t){l.update(e.id,t).then((function(e){e&&(r(a.map((function(t){return t.id!==e.id?t:e}))),s(""),o(""),u({message:"".concat(t.name," updated."),type:"valid"}),setTimeout((function(){u(null)}),4e3))})).catch((function(e){u({message:e.response.data.message,type:"error"}),setTimeout((function(){u(null)}),4e3)}))},j=function(e){l.create(e).then((function(t){t&&(r(a.concat(t)),s(""),o(""),u({message:"".concat(e.name," added."),type:"valid"}),setTimeout((function(){u(null)}),4e3))})).catch((function(e){u({message:e.response.data.message,type:"error"}),setTimeout((function(){u(null)}),4e3)}))};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h2",{children:"Add new"}),Object(d.jsxs)("form",{children:[Object(d.jsxs)("div",{children:["Name: ",Object(d.jsx)("input",{name:"name",value:t,onChange:c})]}),Object(d.jsxs)("div",{children:["Number: ",Object(d.jsx)("input",{name:"number",value:n,onChange:c})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault();var c=a.filter((function(e){return e.name===t}))[0],r={name:t,number:n};c?window.confirm("".concat(c.name," already exists. Do you want to replace the old number?"))&&i(c,r):j(r)},children:"Add"})})]})]})},m=function(e){var t=e.searchName,n=e.handleInputChange;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h2",{children:"Phonebook"}),Object(d.jsxs)("div",{children:["Search: ",Object(d.jsx)("input",{name:"search",value:t,onChange:n})]})]})},b=function(e){var t=e.actionCompleted;return t?Object(d.jsx)("div",{className:t.type,children:Object(d.jsx)("h3",{children:t.message})}):null},p=function(){var e=Object(s.useState)([]),t=Object(r.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),o=Object(r.a)(a,2),u=o[0],i=o[1],p=Object(s.useState)(""),f=Object(r.a)(p,2),O=f[0],x=f[1],g=Object(s.useState)(""),v=Object(r.a)(g,2),w=v[0],C=v[1],N=Object(s.useState)(null),y=Object(r.a)(N,2),A=y[0],k=y[1];Object(s.useEffect)((function(){l.getAll().then((function(e){c(e)}))}),[]);var S=function(e){var t=e.target;"name"===t.name?i(t.value):"number"===t.name?x(t.value):"search"===t.name&&C(t.value)};return Object(d.jsxs)("div",{children:[Object(d.jsx)(b,{actionCompleted:A}),Object(d.jsx)(m,{searchName:w,handleInputChange:S}),Object(d.jsx)(h,{newName:u,persons:n,handleInputChange:S,newNumber:O,setpersons:c,setNewNumber:x,setNewName:i,setActionCompleted:k,actionCompleted:A}),Object(d.jsx)(j,{persons:n,search:w,setpersons:c,setActionCompleted:k,actionCompleted:A})]})};n(40);a.a.render(Object(d.jsx)(p,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.1982370f.chunk.js.map